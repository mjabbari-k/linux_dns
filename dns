#!/bin/sh
# dns - one-shot interactive DNS selector (exits after applying).
# Delegates changes to setdns/nodns.

SETDNS="${SETDNS:-/usr/local/bin/setdns}"
NODNS="${NODNS:-/usr/local/bin/nodns}"

die() { echo "Error: $*"; exit 1; }

[ -x "$SETDNS" ] || die "setdns not found or not executable at: $SETDNS"
[ -x "$NODNS" ] || die "nodns not found or not executable at: $NODNS"

apply_dns() { "$SETDNS" "$1"; }
reset_dns() { "$NODNS"; }

show_menu() {
  echo "============================================================"
  echo "|			                  DNS Selector			                 |"
  echo "============================================================"
  echo "  1) Google DNS 	      2) Cloudflare 		      3) Yandex"
  echo "  4) Shecan             5) Electro		          6) 403"
  echo "  7) OpenDNS            8) CleanBrowsing (Sec)  9) Quad9"
  echo "  10) Add your dns here by editing the dns script"
  echo "  e) Reset to automatic DNS"
  echo "  q) Quit"
}

choice="${1:-}"

if [ -z "$choice" ]; then
  show_menu
  printf "Select option: "
  read -r choice
fi

case "$choice" in
  1) apply_dns "8.8.8.8,8.8.4.4"; exit $?;;
  2) apply_dns "1.1.1.1,1.0.0.1"; exit $?;;
  3) apply_dns "77.88.8.8,77.88.8.1"; exit $?;;
  4) apply_dns "178.22.122.100,185.51.200.2"; exit $?;;
  5) apply_dns "78.157.42.100,78.157.42.101"; exit $?;;
  6) apply_dns "10.202.10.202,10.202.10.102"; exit $?;;
  7) apply_dns "208.67.222.222,208.67.220.220"; exit $?;;
  8) apply_dns "185.228.168.9,185.228.169.9"; exit $?;;
  9) apply_dns "9.9.9.9,149.112.112.112"; exit $?;;
  10) apply_dns "45.90.28.0,45.90.30.0"; exit $?;;
  10) "Coppy and paste a line from the above replace the first and second dns and seperate with ,"; read -r $?;;
  e|E) reset_dns; exit $?;;
  q|Q) exit 0;;
  *) die "Invalid option: $choice";;
esac
